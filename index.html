<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vibe Pomodoro Timer</title>
  <style>
    :root {
      color-scheme: light;
      --bg: #0f172a;
      --surface: #111827;
      --accent: #f59e0b;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --success: #10b981;
      --danger: #ef4444;
      --shadow: 0 20px 60px rgba(0, 0, 0, 0.35);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at 20% 20%, rgba(245, 158, 11, 0.15), transparent 30%),
        radial-gradient(circle at 80% 0%, rgba(16, 185, 129, 0.15), transparent 25%),
        var(--bg);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 32px;
    }

    .card {
      width: min(960px, 100%);
      background: linear-gradient(145deg, rgba(17, 24, 39, 0.92), rgba(15, 23, 42, 0.9));
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 24px;
      box-shadow: var(--shadow);
      padding: 32px;
      display: grid;
      gap: 24px;
      grid-template-columns: 1.25fr 1fr;
      backdrop-filter: blur(10px);
    }

    @media (max-width: 840px) {
      .card {
        grid-template-columns: 1fr;
      }
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    .title {
      font-size: clamp(22px, 3vw, 28px);
      font-weight: 800;
      letter-spacing: -0.02em;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .title .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 0 8px rgba(245, 158, 11, 0.15);
    }

    .pill {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 13px;
      color: var(--muted);
    }

    .timer {
      background: rgba(255, 255, 255, 0.02);
      border-radius: 18px;
      padding: 32px 28px;
      border: 1px solid rgba(255, 255, 255, 0.06);
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.06);
    }

    .mode {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 8px 14px;
      border-radius: 999px;
      background: rgba(245, 158, 11, 0.1);
      color: var(--accent);
      font-weight: 700;
      letter-spacing: 0.01em;
      text-transform: uppercase;
      font-size: 13px;
    }

    .time {
      font-size: clamp(56px, 10vw, 86px);
      font-weight: 800;
      letter-spacing: -0.02em;
      margin: 12px 0;
    }

    .status {
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 14px;
    }

    .bar-bg {
      margin: 18px 0 10px;
      height: 10px;
      background: rgba(255, 255, 255, 0.06);
      border-radius: 999px;
      overflow: hidden;
    }

    .bar {
      height: 100%;
      width: 100%;
      transform-origin: left;
      background: linear-gradient(90deg, var(--accent), #f97316);
      transition: transform 0.2s ease-out;
    }

    .controls {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 16px;
    }

    button {
      appearance: none;
      border: 0;
      border-radius: 12px;
      padding: 14px 18px;
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
      color: var(--text);
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.08);
      transition: transform 0.12s ease, background 0.2s ease, box-shadow 0.2s ease;
    }

    button:hover {
      background: rgba(255, 255, 255, 0.12);
      transform: translateY(-1px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
    }

    button:active {
      transform: translateY(0);
      box-shadow: none;
    }

    .primary {
      background: linear-gradient(135deg, #f59e0b, #f97316);
      color: #0f172a;
      box-shadow: 0 20px 40px rgba(249, 115, 22, 0.35);
      border: none;
    }

    .ghost {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text);
    }

    .danger {
      background: rgba(239, 68, 68, 0.15);
      color: #fecdd3;
      border-color: rgba(239, 68, 68, 0.35);
    }

    .panel {
      background: rgba(255, 255, 255, 0.02);
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.06);
      padding: 18px;
      display: grid;
      gap: 12px;
    }

    .panel h3 {
      margin: 0;
      font-size: 15px;
      letter-spacing: 0.01em;
      color: var(--muted);
      text-transform: uppercase;
    }

    .inputs {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 12px;
    }

    label {
      display: grid;
      gap: 6px;
      font-size: 14px;
      color: var(--text);
    }

    input[type="number"] {
      width: 100%;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: rgba(255, 255, 255, 0.05);
      color: var(--text);
      font-size: 16px;
    }

    input[type="number"]:focus {
      outline: 2px solid rgba(245, 158, 11, 0.45);
      outline-offset: 2px;
    }

    .cycles {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--muted);
      font-size: 14px;
    }

    .cycles strong {
      color: var(--text);
      font-size: 20px;
    }
  </style>
</head>
<body>
  <main class="card">
    <section class="timer">
      <div class="header">
        <div class="title"><span class="dot"></span>Vibe Pomodoro</div>
        <div class="pill" id="cycleLabel">1 サイクル目</div>
      </div>

      <div class="mode" id="modeLabel">Focus</div>
      <div class="time" id="timeDisplay">25:00</div>
      <div class="status" id="statusText">待機中</div>

      <div class="bar-bg">
        <div class="bar" id="progressBar" style="transform: scaleX(1);"></div>
      </div>

      <div class="controls">
        <button class="primary" id="startPause">スタート</button>
        <button class="ghost" id="skip">スキップ</button>
        <button class="danger" id="reset">リセット</button>
      </div>
    </section>

    <section class="panel">
      <h3>設定</h3>
      <div class="inputs">
        <label>
          フォーカス（分）
          <input type="number" id="focusInput" min="1" max="120" value="25" />
        </label>
        <label>
          休憩（分）
          <input type="number" id="breakInput" min="1" max="60" value="5" />
        </label>
      </div>
      <div class="cycles">完了サイクル: <strong id="cycleCount">0</strong></div>
      <p style="margin:0;color:var(--muted);font-size:14px;line-height:1.6;">
        スタートで集中を開始。終了後は自動で休憩に切り替わります。スキップでモードを切替、リセットで最初からやり直せます。
      </p>
    </section>
  </main>

  <script>
    const modeLabel = document.getElementById("modeLabel");
    const timeDisplay = document.getElementById("timeDisplay");
    const statusText = document.getElementById("statusText");
    const progressBar = document.getElementById("progressBar");
    const startPauseBtn = document.getElementById("startPause");
    const resetBtn = document.getElementById("reset");
    const skipBtn = document.getElementById("skip");
    const focusInput = document.getElementById("focusInput");
    const breakInput = document.getElementById("breakInput");
    const cycleCount = document.getElementById("cycleCount");
    const cycleLabel = document.getElementById("cycleLabel");

    const MODE = {
      FOCUS: "focus",
      BREAK: "break",
    };

    let mode = MODE.FOCUS;
    let focusSeconds = minutesToSeconds(focusInput.value);
    let breakSeconds = minutesToSeconds(breakInput.value);
    let remaining = focusSeconds;
    let timerId = null;
    let cyclesCompleted = 0;

    function minutesToSeconds(value) {
      return Math.max(60, Math.min(7200, Math.round(Number(value) * 60)));
    }

    function format(seconds) {
      const m = Math.floor(seconds / 60)
        .toString()
        .padStart(2, "0");
      const s = Math.floor(seconds % 60)
        .toString()
        .padStart(2, "0");
      return `${m}:${s}`;
    }

    function updateDisplay() {
      const total = mode === MODE.FOCUS ? focusSeconds : breakSeconds;
      const progress = Math.max(0, Math.min(1, remaining / total));
      timeDisplay.textContent = format(remaining);
      modeLabel.textContent = mode === MODE.FOCUS ? "Focus" : "Break";
      statusText.textContent = timerId ? "カウント中" : "待機中";
      progressBar.style.transform = `scaleX(${progress})`;
      progressBar.style.background =
        mode === MODE.FOCUS
          ? "linear-gradient(90deg, #f59e0b, #f97316)"
          : "linear-gradient(90deg, #10b981, #22d3ee)";
    }

    function switchMode(nextMode) {
      mode = nextMode;
      remaining = mode === MODE.FOCUS ? focusSeconds : breakSeconds;
      statusText.textContent = "切り替えました";
      if (timerId) {
        clearInterval(timerId);
        timerId = startInterval();
      }
      updateDisplay();
    }

    function handleFinish() {
      if (mode === MODE.FOCUS) {
        cyclesCompleted += 1;
        cycleCount.textContent = cyclesCompleted;
        cycleLabel.textContent = `${cyclesCompleted + 1} サイクル目`;
        switchMode(MODE.BREAK);
      } else {
        switchMode(MODE.FOCUS);
      }
    }

    function startInterval() {
      return setInterval(() => {
        remaining -= 1;
        if (remaining <= 0) {
          handleFinish();
          return;
        }
        updateDisplay();
      }, 1000);
    }

    function startPause() {
      if (timerId) {
        clearInterval(timerId);
        timerId = null;
        startPauseBtn.textContent = "スタート";
        statusText.textContent = "一時停止";
      } else {
        timerId = startInterval();
        startPauseBtn.textContent = "ポーズ";
        statusText.textContent = "カウント中";
      }
      updateDisplay();
    }

    function reset() {
      clearInterval(timerId);
      timerId = null;
      focusSeconds = minutesToSeconds(focusInput.value);
      breakSeconds = minutesToSeconds(breakInput.value);
      remaining = focusSeconds;
      cyclesCompleted = 0;
      cycleCount.textContent = "0";
      cycleLabel.textContent = "1 サイクル目";
      mode = MODE.FOCUS;
      startPauseBtn.textContent = "スタート";
      statusText.textContent = "リセットしました";
      updateDisplay();
    }

    focusInput.addEventListener("change", () => {
      focusSeconds = minutesToSeconds(focusInput.value);
      if (mode === MODE.FOCUS) remaining = focusSeconds;
      updateDisplay();
    });

    breakInput.addEventListener("change", () => {
      breakSeconds = minutesToSeconds(breakInput.value);
      if (mode === MODE.BREAK) remaining = breakSeconds;
      updateDisplay();
    });

    startPauseBtn.addEventListener("click", startPause);
    resetBtn.addEventListener("click", reset);
    skipBtn.addEventListener("click", () => {
      switchMode(mode === MODE.FOCUS ? MODE.BREAK : MODE.FOCUS);
    });

    updateDisplay();
  </script>
</body>
</html>
